const f="https://api.ethos.network/api/v2",h="ethoscan@1.0.0";async function p(t){try{const e=await fetch(`${f}/users/by/address`,{method:"POST",headers:{"Content-Type":"application/json",Accept:"*/*","X-Ethos-Client":h},body:JSON.stringify({addresses:[t]})});if(!e.ok)return e.status===404?{success:!1,error:{message:"Address not found in Ethos network",statusCode:404}}:e.status===400?{success:!1,error:{message:"Invalid Ethereum address format",statusCode:400}}:{success:!1,error:{message:`API request failed with status ${e.status}`,statusCode:e.status}};const s=await e.json();return!s||s.length===0?{success:!1,error:{message:"No profile data returned from API",statusCode:404}}:{success:!0,data:s[0]}}catch(e){return{success:!1,error:{message:e instanceof Error?e.message:"Network request failed",statusCode:0}}}}function m(t){return!t||typeof t!="string"||!t.startsWith("0x")||t.length!==42?!1:/^0x[0-9a-fA-F]{40}$/.test(t)}function w(t){try{const s=new URL(t).hostname.toLowerCase();return s==="etherscan.io"||s.endsWith(".etherscan.io")?"etherscan":s==="blockscan.com"||s.endsWith(".blockscan.com")?"blockscan":s==="debank.com"?"debank":null}catch{return null}}function E(t){const e=w(t);if(!e)return{address:null,explorer:null,isValid:!1};try{const d=new URL(t).pathname;let n=null;if(e==="etherscan"||e==="blockscan"){const r=d.match(/\/address\/([^\/\?#]+)/);r&&r[1]&&(n=r[1])}else if(e==="debank"){const r=d.match(/\/profile\/([^\/\?#]+)/);r&&r[1]&&(n=r[1])}if(!n)return{address:null,explorer:e,isValid:!1};const c=m(n);return{address:c?n:null,explorer:e,isValid:c}}catch{return{address:null,explorer:e,isValid:!1}}}let a=null,l=null,o=null;async function i(){const t=E(window.location.href);if(t.isValid&&t.address){if(t.address===a)return;a=t.address,console.log(`Address detected: ${t.address} on ${t.explorer}`);const e=await p(t.address);e.success?console.log("Ethos profile fetched:",e.data):console.error("Failed to fetch Ethos profile:",e.error)}else a!==null&&(a=null,console.log("No valid Ethereum address found in URL"))}function g(){o=()=>{i()},window.addEventListener("popstate",o),l=window.setInterval(()=>{i()},500)}function v(){o!==null&&(window.removeEventListener("popstate",o),o=null),l!==null&&(clearInterval(l),l=null)}function u(){i(),g()}window.addEventListener("beforeunload",v);document.readyState==="loading"?document.addEventListener("DOMContentLoaded",u):u();
